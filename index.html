<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,viewport-fit=cover"/>
<title>منصّة زد إيمانك | Imani — Web & PWA</title>
<meta name="description" content="منصّة إيمانية تأمّلية وتنموية: تقييم الأسماء الحسنى، ربط هاوكنز وهرم ماسلو، عجلة الحياة، وخطة 14 يومًا مدعومة بآيات وتمارين."/>
<meta name="theme-color" content="#0f6781"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
<meta property="og:title" content="منصّة زد إيمانك"/>
<meta property="og:description" content="تقييم إيماني وخطة عملية في واجهة هادئة احترافية."/>
<meta property="og:type" content="website"/>
<meta property="og:locale" content="ar_SA"/>
<link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
<link id="manifestLink" rel="manifest"/>
<style>
:root{
  --blue:#0f6781; --blue2:#2a7c92; --beige:#efe9dc; --gold:#e6c469;
  --ink:#0f1a20; --muted:#5c6a7a; --card:#fff; --border:#e6ecf2; --badge:#f7fafc;
  --bg:#ffffff; --bg2:#f7f5ef; --shadow:0 18px 60px rgba(0,0,0,.06);
  --safe: env(safe-area-inset-bottom, 0);
}
@media (prefers-color-scheme: dark){
  :root{ --bg:#0b1216; --bg2:#0e161b; --card:#101a20; --ink:#e9eef2; --muted:#a7b3bf; --border:#1f2a33; --badge:#0f1a21; --shadow:0 18px 60px rgba(0,0,0,.22); }
}
*{box-sizing:border-box}html,body{margin:0;height:100%}
html{scroll-behavior:smooth}
*[id]{scroll-margin-top:90px}
@media(min-width:1000px){*[id]{scroll-margin-top:110px}}
body{
  font-family:system-ui,-apple-system,"Tajawal","Noto Kufi Arabic",Segoe UI,Roboto,Arial,sans-serif;
  color:var(--ink);
  background:
    radial-gradient(900px 400px at 100% -20%, rgba(230,196,105,.12), transparent),
    radial-gradient(800px 500px at 0% -30%, rgba(15,103,129,.12), transparent),
    linear-gradient(180deg,var(--bg2) 0%,var(--bg) 60%,var(--bg2) 100%);
}
a{color:inherit;text-decoration:none}
:focus-visible{outline:2px solid var(--gold);outline-offset:2px}
.container{max-width:1200px;margin:0 auto;padding:16px}
.loading-bar{position:fixed;top:0;right:0;left:0;height:3px;background:linear-gradient(90deg,#e6c469,#ffe6a3);transform:scaleX(0);transform-origin:right;z-index:90}
@keyframes loadRun{from{transform:scaleX(0)}to{transform:scaleX(1)}}.loading-bar.active{animation:loadRun .45s ease}
.hide{display:none!important}

/* Header */
.header{position:sticky;top:0;z-index:80;backdrop-filter:blur(12px);background:rgba(255,255,255,.75);border-bottom:1px solid var(--border)}
@media (prefers-color-scheme: dark){.header{background:rgba(16,26,32,.64)}}
.header-inner{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 0}
.brand{display:flex;align-items:center;gap:10px}
.app-logo-wrap{display:flex;flex-direction:column;align-items:center}
.app-logo{width:48px;height:48px;border-radius:14px;background:var(--badge);border:1px solid var(--border);display:grid;place-items:center;padding:6px;box-shadow:0 10px 30px rgba(0,0,0,.06)}
.app-logo svg{width:100%;height:100%}
.app-name{font:700 12px/1 "Amiri",serif;letter-spacing:.2px}
.nav{display:none;gap:6px;flex-wrap:wrap}
.nav a{padding:10px 12px;border-radius:12px;border:1px solid transparent}
.nav a.active{background:rgba(0,0,0,.05);border-color:var(--border)}
.hamburger,.theme-toggle{border:1px solid var(--border);background:var(--card);border-radius:12px;padding:10px 12px;min-height:44px}
.left-logos{display:flex;align-items:center;gap:8px}
.logo{display:inline-flex;align-items:center;justify-content:center;border:1px solid var(--border);border-radius:12px;background:var(--badge);padding:4px;height:28px}
.logo img{max-height:100%;object-fit:contain}
.audio-btn{border:1px solid var(--border);padding:10px 12px;border-radius:12px;background:var(--card)}
@media(min-width:1000px){
  .nav{display:flex}
  .hamburger{display:none}
  .app-logo{width:56px;height:56px;border-radius:18px}
  .logo{height:36px}
}

/* Desktop Enhancements */
.desktop-grid{display:grid;grid-template-columns:260px 1fr;gap:16px}
.sidebar{position:sticky;top:96px;height:calc(100vh - 120px);padding:12px;border:1px solid var(--border);border-radius:16px;background:var(--card)}
.sidebar a{display:block;margin:6px 0;padding:10px;border-radius:10px;border:1px solid transparent}
.sidebar a.active,.sidebar a:hover{background:rgba(0,0,0,.04);border-color:var(--border)}
@media(max-width:1000px){.desktop-grid{display:block}.sidebar{display:none}}

/* Tabbar Mobile */
.tabbar{
  position:fixed;right:0;left:0;bottom:0;padding:8px 10px calc(8px + var(--safe));
  background:rgba(255,255,255,.86);backdrop-filter:blur(10px);border-top:1px solid var(--border);
  display:flex;gap:6px;justify-content:space-around;z-index:85
}
@media (prefers-color-scheme: dark){.tabbar{background:rgba(16,26,32,.78)}}
.tabbar a{flex:1;text-align:center;border:1px solid transparent;background:transparent;padding:10px 6px;border-radius:12px;min-height:44px;display:flex;align-items:center;justify-content:center;font-weight:800}
.tabbar a.active{background:rgba(0,0,0,.05);border-color:var(--border)}
@media(min-width:1000px){.tabbar{display:none}}

/* Layout & Cards */
main{padding-bottom:110px}
.section{margin-top:16px}
.card{background:var(--card);border:1px solid var(--border);border-radius:20px;padding:14px;box-shadow:var(--shadow)}
.shadow{box-shadow:0 22px 80px rgba(15,103,129,.16)}
.grid{display:grid;gap:12px}.cols-2{grid-template-columns:1fr 1fr}.cols-3{grid-template-columns:repeat(3,1fr)}
@media(max-width:1000px){.cols-2,.cols-3{grid-template-columns:1fr}}

/* Hero */
.hero{
  display:grid;gap:14px;grid-template-columns:1fr;align-items:center;padding:14px;border:1px solid var(--border);border-radius:24px;
  background:linear-gradient(135deg,#0f6781 0%,#2a7c92 52%,rgba(230,196,105,.40) 100%);color:#fff;box-shadow:0 18px 80px rgba(15,103,129,.18)
}
@media(min-width:1000px){.hero{grid-template-columns:1.1fr 1fr}}
.hero h1{margin:0 0 8px;font:700 26px/1.35 "Amiri",serif}
.hero p{margin:0;color:#eaf7ff}
.hero .btns{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
.btn{border:none;border-radius:14px;padding:12px 16px;font-weight:800;min-height:44px;cursor:pointer}
.btn-primary{background:var(--gold);color:#1a2228;box-shadow:0 10px 26px rgba(230,196,105,.35)}
.btn-primary:hover{background:#dbb651}
.btn-ghost{background:transparent;border:1px dashed var(--border);color:#fff}
.kpis{display:flex;gap:14px;flex-wrap:wrap;margin-top:8px}
.kpi b{font-size:18px}
.badge{display:inline-block;padding:4px 10px;border-radius:999px;background:var(--badge);border:1px solid var(--border);font-size:12px}
.small{font-size:12px;color:var(--muted)}
.separator{height:1px;background:var(--border);margin:8px 0}

/* Inputs */
.input,select,textarea{width:100%;padding:14px 12px;border:1px solid var(--border);border-radius:14px;background:var(--card);color:var(--ink);font-size:15px}
.range{width:100%;height:36px}
.range::-webkit-slider-thumb{-webkit-appearance:none;width:28px;height:28px;border-radius:50%;background:var(--blue2);border:3px solid #fff;box-shadow:0 1px 4px rgba(0,0,0,.2)}
.range::-moz-range-thumb{width:28px;height:28px;border-radius:50%;background:var(--blue2);border:none}
.notice{padding:10px;border:1px solid var(--border);background:#fffdf5;border-radius:12px}

/* Tables */
.table-wrap{overflow:auto;-webkit-overflow-scrolling:touch}
.table{width:100%;border-collapse:separate;border-spacing:0;min-width:560px}
.table th,.table td{border:1px solid var(--border);padding:10px;border-left:none;border-top:none}
.table th:first-child,.table td:first-child{border-right:1px solid var(--border)}
.table tr:last-child td{border-bottom:1px solid var(--border)}
.table th{background:#f8fafc}

/* Animations & Prefs */
@keyframes fadeUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.reveal>*{opacity:0;transform:translateY(10px)}
.reveal>.anim{animation:fadeUp .5s ease both}
@media (prefers-reduced-motion: reduce){
  html{scroll-behavior:auto}
  .reveal>*{opacity:1;transform:none}
}

/* Footer */
.footer{text-align:center;color:var(--muted);font-size:12px;padding:18px 0;border-top:1px solid var(--border);background:rgba(255,255,255,.6)}
@media print{header,.nav,.left-logos,.tabbar,.footer,.breadcrumbs,.btn,.loading-bar{display:none!important}main{padding:0}.card{border:none}body{background:#fff;color:#000}}
</style>
</head>
<body>
<div class="loading-bar" id="loadingBar"></div>

<header class="header" role="banner">
  <div class="container header-inner">
    <!-- يمين: شعار المنصّة + القوائم -->
    <div class="brand">
      <div class="app-logo-wrap" aria-label="شعار المنصّة">
        <div class="app-logo">
          <svg viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <defs><radialGradient id="g" cx="50%" cy="50%" r="60%"><stop offset="0%" stop-color="#FDE68A" stop-opacity=".95"/><stop offset="60%" stop-color="#60A5FA" stop-opacity=".9"/><stop offset="100%" stop-color="#14B8A6" stop-opacity=".85"/></radialGradient></defs>
            <rect width="256" height="256" rx="44" ry="44" fill="url(#g)"/><circle cx="128" cy="128" r="86" fill="rgba(255,255,255,.15)"/>
            <text x="50%" y="57%" text-anchor="middle" font-family="Tajawal" font-size="120" fill="#0F172A">ز</text>
          </svg>
        </div>
        <div class="app-name">زد إيمانك</div>
      </div>
      <button id="menuBtn" class="hamburger" aria-label="فتح القائمة">القائمة</button>
      <nav class="nav" id="nav" role="navigation" aria-label="القائمة الرئيسية"></nav>
      <button id="themeBtn" class="theme-toggle" title="الوضع الداكن/الفاتح" aria-label="تبديل الوضع">الوضع</button>
    </div>

    <!-- يسار: شعاري الرؤية وتلبية + زر الصوت -->
    <div class="left-logos">
      <div class="logo" title="Vision 2030"><img alt="Vision 2030" src="./Vision2030.png" width="92" height="28" loading="lazy"></div>
      <div class="logo" title="Talbiya"><img alt="Talbiya" src="./talbiya.png" width="92" height="28" loading="lazy"></div>
      <button id="audioBtn" class="audio-btn" aria-label="تشغيل التلاوة">صوت</button>
    </div>
  </div>
</header>

<!-- شريط تنقّل سفلي للجوال -->
<nav class="tabbar" role="navigation" aria-label="تنقّل سفلي">
  <a data-tab href="#/"              data-anchor="#homeTitle">الرئيسية</a>
  <a data-tab href="#/assessment"    data-anchor="#namesSection">التقييم</a>
  <a data-tab href="#/roadmap"       data-anchor="#roadmapTop">الخطة</a>
  <a data-tab href="#/partners"      data-anchor="#partnersTop">الشركاء</a>
  <a data-tab href="#/about"         data-anchor="#aboutTop">عن المنصّة</a>
</nav>

<main id="content" class="container" role="main">
  <div class="desktop-grid">
    <!-- شريط جانبي (كمبيوتر) -->
    <aside class="sidebar" aria-label="روابط سريعة">
      <a href="#/assessment#namesSection">تقييم الأسماء</a>
      <a href="#/assessment#lifeSection">عجلة الحياة</a>
      <a href="#/assessment#resultsSection">النتائج</a>
      <a href="#/roadmap#roadmapTop">خريطة الطريق</a>
      <a href="#/vision2030#visionTop">الارتباط برؤية 2030</a>
      <a href="#/partners#partnersTop">الشركاء</a>
      <a href="#/about#aboutTop">عن المنصّة</a>
    </aside>

    <!-- الصفحات -->
    <div>
      <!-- الرئيسية -->
      <section id="page-home" class="page" aria-labelledby="homeTitle">
        <div class="hero shadow reveal">
          <div class="anim">
            <h1 id="homeTitle" style="font-family:'Amiri',serif">إيماني المعاصر — زد إيمانك</h1>
            <p>واجهة عالمية هادئة تعزّز الإيمان عبر الأسماء الحسنى، وتربط تقدّمك بسُلّم هاوكنز، هرَم ماسلو، وعجلة الحياة — ثم تمنحك خطة 14 يومًا مستندة إلى آيات وتمارين نفسية.</p>
            <div class="btns">
              <a class="btn btn-primary" href="#/assessment" data-anchor="#namesSection">ابدأ التقييم الآن</a>
              <a class="btn btn-ghost"   href="#/vision2030" data-anchor="#visionTop">الارتباط برؤية 2030</a>
            </div>
            <div class="kpis">
              <div class="kpi"><b id="kpiFaith">—%</b><span class="small">نسبة الإيمان</span></div>
              <div class="kpi"><b id="kpiHawkins">—</b><span class="small">سُلّم هاوكنز</span></div>
              <div class="kpi"><b id="kpiMaslow">—</b><span class="small">هرم ماسلو</span></div>
            </div>
          </div>
          <div class="anim" id="dailyAyah">
            <div class="ayah" style="font-family:'Amiri',serif">﴿وَلِلَّهِ الأَسْمَاءُ الْحُسْنَى فَادْعُوهُ بِهَا﴾</div>
            <div class="small">الأعراف: 180</div>
          </div>
        </div>
      </section>

      <!-- التقييم -->
      <section id="page-assessment" class="page hide" aria-labelledby="assessTitle">
        <div id="assessTop"></div>
        <div class="reveal">
          <nav class="breadcrumbs anim"><a href="#/" data-anchor="#homeTitle">الرئيسية</a> · <b id="assessTitle">التقييم الإيماني</b></nav>
          <div class="grid cols-2">
            <div class="card anim" id="namesSection">
              <h3 style="font-family:'Amiri',serif">١) تقييم الأسماء الحسنى</h3>
              <div style="display:flex;gap:8px;align-items:center;margin:6px 0">
                <input id="searchName" class="input" placeholder="ابحث عن اسم (الشافي، الحكيم، الرزّاق…)" aria-label="بحث"/>
                <span class="badge">0–100</span>
              </div>
              <div id="namesWrap" class="grid cols-2" style="margin-top:8px;max-height:420px;overflow:auto"></div>
              <div class="separator"></div>
              <div style="display:flex;gap:8px;flex-wrap:wrap">
                <button class="btn btn-primary" onclick="saveNames()">حفظ التقييم</button>
                <button class="btn" onclick="exportData()">تصدير</button>
                <label class="btn" for="importFile" style="cursor:pointer">استيراد</label>
                <input id="importFile" type="file" accept="application/json" style="display:none" onchange="importData(event)"/>
                <a class="btn" href="#/assessment" data-anchor="#lifeSection">إلى عجلة الحياة</a>
              </div>
            </div>
            <div class="card anim" id="lifeSection">
              <h3 style="font-family:'Amiri',serif">٢) عجلة الحياة (٨ جوانب)</h3>
              <p class="small">قيّم رضاك (0–10) بكل جانب.</p>
              <div id="lifeWrap" class="grid cols-2" style="margin-top:8px"></div>
              <div class="separator"></div>
              <div style="display:flex;gap:8px;flex-wrap:wrap">
                <button class="btn btn-primary" onclick="saveLife()">حفظ العجلة</button>
                <button class="btn" onclick="shareProgress()">مشاركة</button>
                <a class="btn" href="#/assessment" data-anchor="#resultsSection">إلى النتائج</a>
              </div>
            </div>
          </div>

          <div class="section grid cols-3">
            <div class="card anim" id="resultsSection">
              <h3 style="font-family:'Amiri',serif">٣) النتائج الفورية</h3>
              <div class="kpis">
                <div class="kpi"><b id="faithPct">—%</b><span class="small">نسبة الإيمان</span></div>
                <div class="kpi"><b id="hawkinsLevel">—</b><span class="small">هاوكنز</span></div>
                <div class="kpi"><b id="maslowTier">—</b><span class="small">ماسلو</span></div>
              </div>
              <p class="small" id="levelBlurb" style="margin-top:8px"></p>
              <a class="btn" href="#/roadmap" data-anchor="#roadmapTop" style="margin-top:8px">اذهب إلى خريطة الطريق</a>
            </div>
            <div class="card anim" id="hawkinsSection">
              <h3 style="font-family:'Amiri',serif">٤) سُلّم هاوكنز</h3>
              <div class="table-wrap"><table class="table small"><thead><tr><th>النطاق</th><th>الشعور</th><th>القيمة</th><th>توصية</th></tr></thead><tbody id="hawkinsTable"></tbody></table></div>
            </div>
            <div class="card anim" id="maslowSection">
              <h3 style="font-family:'Amiri',serif">٥) هرم ماسلو</h3>
              <div class="table-wrap"><table class="table small">
                <thead><tr><th>الطبقة</th><th>الوصف</th><th>تطبيق</th></tr></thead>
                <tbody id="maslowTable">
                  <tr><td>فسيولوجي</td><td>طعام، نوم، صحّة</td><td>تنظيم النوم والغذاء</td></tr>
                  <tr><td>أمان</td><td>استقرار، مال، سكن</td><td>ميزانية أسبوعية وروتين</td></tr>
                  <tr><td>انتماء</td><td>علاقات، محبّة</td><td>صلة رحم وصحبة صالحة</td></tr>
                  <tr><td>تقدير</td><td>إنجاز، ثقة</td><td>هدف صغير يومي</td></tr>
                  <tr><td>تحقيق الذات</td><td>شغف، معنى</td><td>خدمة وتعلّم</td></tr>
                  <tr><td>السموّ بالإيمان</td><td>وعي روحي</td><td>خلوة وذكر وتدبّر</td></tr>
                </tbody></table></div>
            </div>
          </div>
        </div>
      </section>

      <!-- خريطة الطريق -->
      <section id="page-roadmap" class="page hide" aria-labelledby="roadTitle">
        <div id="roadmapTop"></div>
        <div class="reveal">
          <nav class="breadcrumbs anim"><a href="#/" data-anchor="#homeTitle">الرئيسية</a> · <b id="roadTitle">خريطة الطريق</b></nav>
          <div class="card anim">
            <h3 class="title-flash-target" style="font-family:'Amiri',serif">خطة شخصية لمدة ١٤ يومًا</h3>
            <p class="small">حسب الإيمان/هاوكنز/ماسلو/عجلة الحياة.</p>
            <div id="roadmapPlan" class="grid" style="margin-top:8px"></div>
            <div class="separator"></div>
            <div style="display:flex;gap:8px;flex-wrap:wrap">
              <button class="btn btn-primary" onclick="downloadPlan()">حفظ كـ HTML</button>
              <button class="btn btn-ghost" onclick="window.print()">طباعة</button>
              <a class="btn" href="#/assessment" data-anchor="#resultsSection">العودة للنتائج</a>
            </div>
          </div>
        </div>
      </section>

      <!-- الارتباط برؤية 2030 -->
      <section id="page-vision2030" class="page hide" aria-labelledby="vTitle">
        <div id="visionTop"></div>
        <div class="reveal">
          <nav class="breadcrumbs anim"><a href="#/" data-anchor="#homeTitle">الرئيسية</a> · <b id="vTitle">الارتباط برؤية 2030</b></nav>
          <div class="grid cols-2">
            <div class="card anim">
              <h3 class="title-flash-target" style="font-family:'Amiri',serif">محاور الانسجام</h3>
              <ul class="small" style="line-height:1.9;padding-right:18px">
                <li><b>تعزيز القيم الإسلامية والهوية الوطنية</b> — الوسطية/التسامح/الإتقان/العدالة/المثابرة.</li>
                <li><b>تمكين حياة عامرة وصحّية</b> — نمط صحي وجودة حياة وثقافة وترفيه هادف.</li>
                <li><b>مسؤولية اجتماعية</b> — أثر غير ربحي وتمكين للفرد والمنظمة.</li>
              </ul>
            </div>
            <div class="card anim">
              <h3 style="font-family:'Amiri',serif">مؤشرات قابلة للقياس</h3>
              <ul class="small" style="line-height:1.9;padding-right:18px">
                <li>تحسّن ≥ 3 جوانب من عجلة الحياة.</li>
                <li>ارتفاع “نسبة الإيمان” ≥ 10 نقاط.</li>
                <li>الصعود مستوى واحد على الأقل في هاوكنز.</li>
              </ul>
              <div class="notice small">إمكانية الربط ببرامج التطوّع وجودة الحياة.</div>
            </div>
          </div>
        </div>
      </section>

      <!-- الشركاء -->
      <section id="page-partners" class="page hide" aria-labelledby="pTitle">
        <div id="partnersTop"></div>
        <div class="reveal">
          <nav class="breadcrumbs anim"><a href="#/" data-anchor="#homeTitle">الرئيسية</a> · <b id="pTitle">شركاؤنا</b></nav>
          <div class="card anim" style="text-align:center">
            <h3 class="title-flash-target" style="margin:0 0 8px;font-family:'Amiri',serif">دعوة للشراكة</h3>
            <p class="small" style="color:var(--muted);margin:0 0 10px">
              انضمّ إلى شركاء الإيمان والتنمية؛ كن جزءًا من أثرٍ مستدام يدعم مشاريع المنصّة ويُمكّن الوعي الروحي والمجتمعي.
            </p>
            <button class="btn btn-primary" onclick="openPartnerForm()">انضمّ كشريك</button>
          </div>
          <div class="card anim">
            <h3 style="font-family:'Amiri',serif">الشركاء والداعمون</h3>
            <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px">
              <div class="logo" title="مبادرة تلبية"><img alt="مبادرة تلبية" src="./talbiya.png" width="120" height="32" loading="lazy"></div>
              <div class="logo" title="شركة تلبية"><span style="font-weight:700;color:#0f6781">شركة تلبية</span></div>
            </div>
          </div>
          <a href="javascript:void(0)" onclick="openPartnerForm()" id="floatPartnerBtn"
             style="position:fixed;inset:auto 16px calc(16px + var(--safe)) 16px auto;background:var(--gold);color:#1a2228;padding:12px 16px;border-radius:999px;
                    box-shadow:0 16px 40px rgba(230,196,105,.35);z-index:75;font-weight:800;display:none">انضمّ كشريك</a>
        </div>
      </section>

      <!-- عن المنصّة -->
      <section id="page-about" class="page hide" aria-labelledby="aTitle">
        <div id="aboutTop"></div>
        <div class="reveal">
          <nav class="breadcrumbs anim"><a href="#/" data-anchor="#homeTitle">الرئيسية</a> · <b id="aTitle">عن المنصّة</b></nav>
          <div class="card anim">
            <h3 class="title-flash-target" style="font-family:'Amiri',serif">عن منصّة زد إيمانك</h3>
            <p class="small">
              منصّة رقمية تأمّلية وتنموية تُعزّز الإيمان بالله عبر التفاعل مع الأسماء الحسنى وتطبيقاتها العملية، مستندةً إلى مبادئ علم النفس الإيجابي،
              وسُلّم هاوكنز وهرم ماسلو؛ لتزويدك بخريطة طريق عملية تُحسّن جودة حياتك روحانيًا ونفسيًا وسلوكيًا.
            </p>
            <h4 style="font-family:'Amiri',serif">الرؤية</h4><p class="small">أن تكون المرجع الرقمي الأوّل لتطوير الإيمان الواعي عربيًا.</p>
            <h4 style="font-family:'Amiri',serif">الرسالة</h4><p class="small">تمكين الأفراد من بناء توازن روحاني ونفسي وسلوكي عبر تقييمٍ وتأمّلٍ وخططٍ تنمويةٍ مستندة إلى القيم القرآنية والعلمية.</p>
            <h4 style="font-family:'Amiri',serif">الأهداف</h4>
            <ul class="small" style="line-height:1.9;padding-right:18px">
              <li>ربط الإيمان بالوعي والسلوك اليومي.</li><li>تعريف المستخدم بمستوى وعيه وفق هاوكنز.</li>
              <li>تحقيق التوازن عبر ماسلو وعجلة الحياة.</li><li>خطط ١٤ يومًا قابلة للقياس ومدعومة بآيات وتمارين.</li>
              <li>الإسهام في مستهدفات رؤية 2030 (جودة الحياة وتعزيز القيم الإسلامية).</li>
            </ul>
          </div>
        </div>
      </section>
    </div>
  </div>
</main>

<footer class="footer" role="contentinfo">
  © جميع الحقوق محفوظة لشركة <b>تلبية للبحث والتطوير</b> — <span id="year"></span>
</footer>

<!-- نموذج الشراكة -->
<dialog class="partner-modal" id="partnerModal">
  <form method="dialog">
    <div class="modal-head" style="display:flex;justify-content:space-between;align-items:center;gap:8px;margin-bottom:8px">
      <b>نموذج انضمام الشركاء</b>
      <button class="btn" onclick="partnerModal.close()">إغلاق</button>
    </div>
    <div class="modal-body">
      <div class="grid cols-2">
        <label class="card"><span class="small">الاسم الكامل</span><input id="pf_name" class="input" required/></label>
        <label class="card"><span class="small">المنظمة/الجهة</span><input id="pf_org" class="input"/></label>
      </div>
      <div class="grid cols-2" style="margin-top:8px">
        <label class="card"><span class="small">البريد الإلكتروني</span><input id="pf_email" type="email" class="input" required/></label>
        <label class="card"><span class="small">الهاتف (اختياري)</span><input id="pf_phone" class="input"/></label>
      </div>
      <div class="grid" style="margin-top:8px">
        <label class="card"><span class="small">نوع الشراكة</span>
          <select id="pf_type" class="input" required>
            <option value="" selected disabled>اختر النوع</option>
            <option>مالية</option><option>علمية</option><option>إعلامية</option><option>تقنية</option><option>أخرى</option>
          </select>
        </label>
      </div>
      <label class="card" style="margin-top:8px"><span class="small">رسالة/اهتمام</span><textarea id="pf_msg" class="input" rows="4" placeholder="عرّف بنا وبمجال الشراكة"></textarea></label>
      <div class="notice small" style="margin-top:8px">سيُنشأ بريد مسوّدة تلقائيًا لإرساله لنا.</div>
    </div>
    <div class="modal-actions" style="display:flex;gap:8px;justify-content:flex-start;margin-top:8px">
      <button class="btn btn-primary" onclick="submitPartnerForm()">إرسال</button>
      <button class="btn" type="reset">تفريغ</button>
    </div>
  </form>
</dialog>

<script>
/* ====== PWA (manifest + SW) ====== */
const OFFLINE_HTML=`<!doctype html><meta charset="utf-8"><title>وضع عدم الاتصال</title><style>body{font-family:system-ui,"Tajawal";direction:rtl;padding:20px}</style><h2>أنت غير متصل</h2><p>ستعمل الأجزاء المحفوظة مسبقًا، وتُحدّث عند عودة الشبكة.</p>`;
const manifest={"name":"منصّة زد إيمانك","short_name":"زد إيمانك","start_url":"./?pwa=true","display":"standalone","lang":"ar","dir":"rtl","theme_color":"#0f6781","background_color":"#ffffff","icons":[
 {"src":"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'><rect rx='28' ry='28' width='128' height='128' fill='%230f6781'/><text x='64' y='84' text-anchor='middle' font-size='84' fill='white'>ز</text></svg>","sizes":"128x128","type":"image/svg+xml"},
 {"src":"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect rx='80' ry='80' width='512' height='512' fill='%230f6781'/><text x='256' y='320' text-anchor='middle' font-size='300' fill='white'>ز</text></svg>","sizes":"512x512","type":"image/svg+xml","purpose":"maskable any"}
],"shortcuts":[{"name":"ابدأ التقييم","url":"#/assessment#namesSection","icons":[{"src":"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'><circle cx='64' cy='64' r='60' fill='%23e6c469'/><text x='64' y='84' text-anchor='middle' font-size='72' fill='%230f1a20'>✓</text></svg>","sizes":"128x128","type":"image/svg+xml"}]}]};
(function(){const link=document.getElementById('manifestLink');const url=URL.createObjectURL(new Blob([JSON.stringify(manifest)],{type:'application/manifest+json'}));link.href=url;})();
(function(){if('serviceWorker' in navigator){
  const sw=`const CACHE='iman-v8';let OFFLINE_URL='offline.html';
self.addEventListener('install',e=>{e.waitUntil((async()=>{const c=await caches.open(CACHE);await c.addAll(['./',OFFLINE_URL]);})());self.skipWaiting();});
self.addEventListener('activate',e=>self.clients.claim());
self.addEventListener('fetch',e=>{e.respondWith((async()=>{try{const net=await fetch(e.request);const c=await caches.open(CACHE);c.put(e.request,net.clone());return net;}catch(err){const m=await caches.match(e.request);return m||caches.match(OFFLINE_URL);}})());});`;
  const offlineUrl=URL.createObjectURL(new Blob([OFFLINE_HTML],{type:'text/html'}));
  const swUrl=URL.createObjectURL(new Blob([sw.replace("OFFLINE_URL='offline.html'","OFFLINE_URL='"+offlineUrl+"'")],{type:'text/javascript'}));
  navigator.serviceWorker.register(swUrl);
}})();

/* ====== Utilities ====== */
const loadingBar=document.getElementById('loadingBar');
function runLoading(){loadingBar.classList.add('active');setTimeout(()=>loadingBar.classList.remove('active'),450);}
function vibrate(ms=18){try{navigator.vibrate&&navigator.vibrate(ms);}catch{}}
function headerOffset(){const h=document.querySelector('.header');return (h?.offsetHeight||90)+6;}
function smoothTo(el){if(!el)return;const top=el.getBoundingClientRect().top+window.scrollY-headerOffset();window.scrollTo({top,behavior:'smooth'});}

/* ====== Routing & Anchors ====== */
const routes=[
  {hash:"#/",label:"الرئيسية",defaultAnchor:"#homeTitle"},
  {hash:"#/assessment",label:"التقييم",defaultAnchor:"#namesSection"},
  {hash:"#/roadmap",label:"الخطة",defaultAnchor:"#roadmapTop"},
  {hash:"#/vision2030",label:"الارتباط برؤية 2030",defaultAnchor:"#visionTop"},
  {hash:"#/partners",label:"الشركاء",defaultAnchor:"#partnersTop"},
  {hash:"#/about",label:"عن المنصّة",defaultAnchor:"#aboutTop"}
];
const nav=document.getElementById('nav');
routes.forEach(r=>{const a=document.createElement('a');a.href=r.hash;a.textContent=r.label;a.setAttribute('data-route','');a.setAttribute('data-anchor',r.defaultAnchor);nav.appendChild(a);});
document.addEventListener('click',(e)=>{
  const a=e.target.closest('a[href]');
  if(!a) return;
  const d=a.getAttribute('data-anchor')||"";
  if(d) sessionStorage.setItem('pendingAnchor', d);
  const href=a.getAttribute('href')||"";
  const m=href.match(/^#\/[^#]+#(.+)$/);
  if(m) sessionStorage.setItem('pendingAnchor', '#'+m[1]);
},{capture:true});

function setActiveLink(hash){
  document.querySelectorAll('[data-route]').forEach(a=>a.classList.toggle('active',a.getAttribute('href')===hash));
  document.querySelectorAll('.tabbar [data-tab]').forEach(a=>a.classList.toggle('active',a.getAttribute('href')===hash));
  document.querySelectorAll('.sidebar a').forEach(a=>a.classList.toggle('active',a.getAttribute('href').startsWith(hash)));
}

const menuBtn=document.getElementById('menuBtn');menuBtn.addEventListener('click',()=>nav.classList.toggle('open'));
document.addEventListener('click',e=>{if(!nav.contains(e.target)&&e.target!==menuBtn)nav.classList.remove('open');},{passive:true});

function route(){
  runLoading();
  const full=location.hash||"#/";
  const page = "#/"+(full.split('#/')[1]?.split('#')[0] || (full==="#/"?"":""));
  const current = page || full;

  document.querySelectorAll('.page').forEach(p=>p.classList.add('hide'));
  const id=(current==="#/")?"page-home":(current==="#/assessment")?"page-assessment":(current==="#/roadmap")?"page-roadmap":(current==="#/vision2030")?"page-vision2030":(current==="#/partners")?"page-partners":"page-about";
  document.getElementById(id).classList.remove('hide');

  if(current==="#/assessment"){buildNames();buildLife();randomAyah();fillHawkinsTable();}
  if(current==="#/roadmap"){renderRoadmap();}
  if(current==="#/partners"){toggleFloatPartner(true);}else{toggleFloatPartner(false);}
  if(current!=="#/"){audioPauseSoft();}
  setActiveLink(current);

  const fromUrl = full.includes('#/#') ? '#'+full.split('#/')[1].split('#')[1] : '';
  const pending = sessionStorage.getItem('pendingAnchor') || "";
  const fallback = (routes.find(x=>x.hash===current)||routes[0]).defaultAnchor;
  const anchor = fromUrl || pending || fallback;
  setTimeout(()=>{const el=anchor?document.querySelector(anchor):null; if(el){smoothTo(el)} else {window.scrollTo({top:0,behavior:'smooth'})} sessionStorage.removeItem('pendingAnchor');}, 30);
}
window.addEventListener('hashchange',route);

/* ====== Audio (لطيف) ====== */
const audio=new Audio();audio.loop=true;
const audioBtn=document.getElementById('audioBtn');let audioOn=false;
function audioPauseSoft(){if(!audio.paused){audio.pause();audioOn=false;audioBtn.textContent='صوت';}}
audioBtn.addEventListener('click',async()=>{try{if(!audioOn){await audio.play();audioOn=true;audioBtn.textContent='إيقاف';}else{audio.pause();audioOn=false;audioBtn.textContent='صوت';}}catch(e){}});

/* ====== Data ====== */
const NAMES_99=["الله","الرحمن","الرحيم","الملك","القدوس","السلام","المؤمن","المهيمن","العزيز","الجبار","المتكبر","الخالق","البارئ","المصور","الغفار","القهار","الوهاب","الرزاق","الفتاح","العليم","القابض","الباسط","الخافض","الرافع","المعز","المذل","السميع","البصير","الحكم","العدل","اللطيف","الخبير","الحليم","العظيم","الغفور","الشكور","العلي","الكبير","الحفيظ","المقيت","الحسيب","الجليل","الكريم","الرقيب","المجيب","الواسع","الحكيم","الودود","المجيد","الباعث","الشهيد","الحق","الوكيل","القوي","المتين","الولي","الحميد","المحصي","المبدئ","المعيد","المحيي","المميت","الحي","القيوم","الواجد","الماجد","الواحد","الأحد","الصمد","القادر","المقتدر","المقدم","المؤخر","الأول","الآخر","الظاهر","الباطن","الوالي","المتعالي","البر","التواب","المنتقم","العفو","الرؤوف","مالك الملك","ذو الجلال والإكرام","المقسط","الجامع","الغني","المغني","المانع","الضار","النافع","النور","الهادي","البديع","الباقي","الوارث","الرشيد","الصبور","الشافي"];
const LIFE_AREAS=["الإيمان/الروح","الصحّة","العائلة","العلاقات","العمل/المال","العِلم/التعلّم","العطاء/الأثر","الهوايات/المتعة"];
const K={names:"iman_names",life:"iman_life"};
function load(k){try{return JSON.parse(localStorage.getItem(k))}catch{return null}}
function save(k,v){localStorage.setItem(k,JSON.stringify(v));}
let namesScores=load(K.names)||Object.fromEntries(NAMES_99.map(n=>[n,50]));
let lifeScores=load(K.life)||Object.fromEntries(LIFE_AREAS.map(n=>[n,5]));
function avg(a){return a.reduce((x,y)=>x+y,0)/Math.max(a.length,1);}
function byId(id){return document.getElementById(id)}
function el(tag,attrs={},children=[]){const e=document.createElement(tag);Object.entries(attrs).forEach(([k,v])=>{if(k==="class")e.className=v;else if(k==="html")e.innerHTML=v;else e.setAttribute(k,v);});(Array.isArray(children)?children:[children]).filter(Boolean).forEach(c=>e.appendChild(c));return e;}

/* أسماء */
function buildNames(){const wrap=byId('namesWrap');wrap.innerHTML="";const q=(byId('searchName').value||"").trim();const list=q?NAMES_99.filter(n=>n.includes(q)):NAMES_99;list.forEach(name=>{const val=namesScores[name]??50;wrap.appendChild(el("div",{class:"card anim"},[el("div",{html:`<b>${name}</b> <span class='badge' style='float:left'>${val}%</span>`}),el("input",{type:"range",min:"0",max:"100",value:String(val),class:"range",oninput:`updateName('${name}', this.value, this.previousElementSibling.querySelector('.badge'))`})]));});}
byId('searchName')?.addEventListener('input',buildNames,{passive:true});
function updateName(n,v,b){namesScores[n]=Number(v);b.textContent=v+"%";}
function saveNames(){save(K.names,namesScores);refreshAll();alert("تم حفظ تقييم الأسماء.");}

/* Export/Import */
function exportData(){const data={names:namesScores,life:lifeScores};const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='iman-data.json';a.click();}
function importData(e){const f=e.target.files?.[0];if(!f)return;const r=new FileReader();r.onload=()=>{try{const o=JSON.parse(r.result);if(o.names)namesScores=o.names;if(o.life)lifeScores=o.life;save(K.names,namesScores);save(K.life,lifeScores);buildNames();buildLife();drawRadar();refreshAll();alert("تم الاستيراد.");}catch{alert("ملف غير صالح.");}};r.readAsText(f);}

/* عجلة الحياة */
function buildLife(){const wrap=byId('lifeWrap');wrap.innerHTML="";LIFE_AREAS.forEach(a=>{const v=lifeScores[a]??5;wrap.appendChild(el("div",{class:"card anim"},[el("div",{html:`<b>${a}</b> <span class='badge' style='float:left'>${v}/10</span>`}),el("input",{type:"range",min:"0",max:"10",value:String(v),class:"range",oninput:`updateLife('${a}', this.value, this.previousElementSibling.querySelector('.badge'))`})]));});}
function updateLife(a,v,b){lifeScores[a]=Number(v);b.textContent=v+"/10";}
function saveLife(){save(K.life,lifeScores);drawRadar();refreshAll();alert("تم حفظ عجلة الحياة.");}

/* هاوكنز/ماسلو */
const HAWK_MAP=[{range:"0–20",label:"خزي/عار",code:20,note:"بدء قبول الذات والرحمة"},{range:"20–35",label:"ذنب/أسى",code:75,note:"توبة + امتنان يومي"},{range:"35–50",label:"خوف/قلق",code:100,note:"توكّل عملي"},{range:"50–60",label:"شجاعة",code:200,note:"عادة صغيرة مستمرة"},{range:"60–70",label:"قبول/حياد",code:300,note:"اتزان وروتين ذكر"},{range:"70–80",label:"محبّة/بهجة",code:500,note:"تكثير العطاء"},{range:"80–90",label:"سلام",code:600,note:"خلوة وتدبّر"},{range:"90–100",label:"نور/سكون",code:700,note:"صفاء وخدمة بإخلاص"}];
function fillHawkinsTable(){const tb=byId('hawkinsTable');tb.innerHTML="";HAWK_MAP.forEach(r=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${r.range}</td><td>${r.label}</td><td>${r.code}</td><td>${r.note}</td>`;tb.appendChild(tr);});}
function computeFaithPct(){return Math.round(avg(Object.values(namesScores)));}
function computeLifeAvg(){return avg(Object.values(lifeScores));}
function mapHawkins(p){if(p<20)return HAWK_MAP[0];if(p<35)return HAWK_MAP[1];if(p<50)return HAWK_MAP[2];if(p<60)return HAWK_MAP[3];if(p<70)return HAWK_MAP[4];if(p<80)return HAWK_MAP[5];if(p<90)return HAWK_MAP[6];return HAWK_MAP[7];}
function mapMaslow(a){if(a<3)return "فسيولوجي/أمان";if(a<5)return "انتماء/علاقات";if(a<7)return "تقدير/إنجاز";return "تحقيق الذات (+ السموّ بالإيمان)";}
function refreshAll(){
  const p=computeFaithPct(),h=mapHawkins(p),la=computeLifeAvg(),m=mapMaslow(la);
  byId('kpiFaith').textContent=p+"%";
  byId('kpiHawkins').textContent=`${h.label} (${h.code})`;
  byId('kpiMaslow').textContent=m;
  byId('faithPct').textContent=p+"%";
  byId('hawkinsLevel').textContent=`${h.label} (${h.code})`;
  byId('maslowTier').textContent=m;
  byId('levelBlurb').textContent=`نبرة الوعي: ${h.label} — توصية: ${h.note}`;
}

/* آيات */
const AYAT=[{text:"﴿وَمَن يَتَوَكَّلْ عَلَى اللَّهِ فَهُوَ حَسْبُهُ﴾",ref:"الطلاق: 3"},{text:"﴿إِنَّ مَعَ الْعُسْرِ يُسْرًا﴾",ref:"الشرح: 6"},{text:"﴿قُلْ يَا عِبَادِيَ الَّذِينَ أَسْرَفُوا...﴾",ref:"الزمر: 53"},{text:"﴿ادْعُونِي أَسْتَجِبْ لَكُمْ﴾",ref:"غافر: 60"},{text:"﴿وَقُل رَّبِّ زِدْنِي عِلْمًا﴾",ref:"طه: 114"}];
function randomAyah(){const a=AYAT[Math.floor(Math.random()*AYAT.length)];const el=document.getElementById('dailyAyah');if(el)el.innerHTML=`<div class="ayah" style="font-family:'Amiri',serif">${a.text}</div><div class="small">${a.ref}</div>`;}

/* Radar */
let radar;function drawRadar(){const ctx=document.getElementById('radar')?.getContext('2d');if(!ctx)return;const labels=LIFE_AREAS;const data=labels.map(l=>lifeScores[l]);if(radar)radar.destroy();radar=new Chart(ctx,{type:'radar',data:{labels,datasets:[{label:'عجلة الحياة',data,fill:true,borderWidth:2}]},options:{responsive:true,plugins:{legend:{display:false}},scales:{r:{suggestedMin:0,suggestedMax:10,ticks:{stepSize:2}}}}});}

/* Roadmap */
const NAME_BY_STATE={low:"الرحمن",mid:"اللطيف",high:"الحكيم"};
const AYAH_BY_STATE={low:"﴿وَمَن يَتَوَكَّلْ عَلَى اللَّهِ فَهُوَ حَسْبُهُ﴾",mid:"﴿إِنَّ مَعَ الْعُسْرِ يُسْرًا﴾",high:"﴿وَقُل رَّبِّ زِدْنِي عِلْمًا﴾"};
const CBT_LIBRARY={thought:"اكتب فكرة مزعجة ثم بديلًا رحيمًا وسلوكًا نافعًا صغيرًا.",gratitude:"سجّل 3 نِعَم اليوم.",breath:"تنفّس 4-4-6 لدقيقة.",tinyHabit:"عادة دقيقة مرتبطة بإشارة ثابتة."};
function stateBand(p){return p<60?'low':(p<80?'mid':'high');}
function roadmapBlocks(pct,haw,life){
  const lowAreas=Object.entries(life).sort((a,b)=>a[1]-b[1]).slice(0,3).map(x=>x[0]);
  const band=stateBand(pct);const anchorName=NAME_BY_STATE[band];const anchorAyah=AYAH_BY_STATE[band];
  const anchors=[`ذكر: "يا ${anchorName}" 100 مرة`,`آية: ${anchorAyah}`];
  const psych=(band==='low')?CBT_LIBRARY.thought:(band==='mid')?CBT_LIBRARY.gratitude:CBT_LIBRARY.tinyHabit;
  const items=[];
  for(let d=1;d<=14;d++){
    const area=lowAreas[d%lowAreas.length];
    const practice=(d%3===1)?psych:((d%3===2)?CBT_LIBRARY.breath:CBT_LIBRARY.tinyHabit);
    items.push({title:`اليوم ${d}: ${area}`,desc:[...anchors,`خطوة ${area}: 10–20 دقيقة`,practice,"لُطف خفي لشخص"].join(" — ")});
  }
  items.push({title:"مراجعة خفيفة",desc:"قيّم التزامك وعدّل الخطة."});
  items.push({title:"تثبيت عادة",desc:"اختر عادة للاستمرار 30 يومًا."});
  return items;
}
function renderRoadmap(){
  const pct=computeFaithPct();const haw=mapHawkins(pct);
  const host=document.getElementById('roadmapPlan');if(!host)return;host.innerHTML="";
  roadmapBlocks(pct,haw,lifeScores).forEach(it=>{
    host.appendChild(el("label",{class:"card",html:`<div style="display:flex;gap:10px;align-items:flex-start"><input type="checkbox" style="margin-top:6px"/><div><b>${it.title}</b><div class="small" style="color:#64748b">${it.desc}</div></div></div>`}));
  });
}
function downloadPlan(){
  const html=`<!doctype html><meta charset="utf-8"><title>خطة زد إيمانك (14 يومًا)</title><style>body{font-family:system-ui,"Tajawal";direction:rtl;padding:20px} .task{margin:8px 0;padding:10px;border:1px solid #ddd;border-radius:10px}</style><h2>خطة زد إيمانك (14 يومًا)</h2>${document.getElementById('roadmapPlan').innerHTML}<footer style="margin-top:16px;color:#777;font-size:12px">© شركة تلبية للبحث والتطوير</footer>`;
  const blob=new Blob([html],{type:"text/html"});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download="iman-roadmap.html";a.click();
}

/* Share */
async function shareProgress(){
  const p=computeFaithPct(),h=mapHawkins(p),m=mapMaslow(computeLifeAvg());
  const text=`نتيجتي: إيمان ${p}% — هاوكنز: ${h.label} (${h.code}) — ماسلو: ${m}`;
  if(navigator.share){try{await navigator.share({title:'زد إيمانك',text});}catch(_){}} else {navigator.clipboard?.writeText(text);alert('نُسخت النتيجة.');}
}

/* شراكات */
function openPartnerForm(){partnerModal.showModal();}
function submitPartnerForm(){
  const name=document.getElementById('pf_name').value.trim(),org=document.getElementById('pf_org').value.trim(),email=document.getElementById('pf_email').value.trim(),phone=document.getElementById('pf_phone').value.trim(),type=document.getElementById('pf_type').value.trim(),msg=document.getElementById('pf_msg').value.trim();
  if(!name||!email||!type){alert('فضلاً أدخل الاسم والبريد ونوع الشراكة.');return;}
  const body=`مرحبًا،\nأرغب بالانضمام كشريك في (زد إيمانك).\n\nالاسم: ${name}\nالمنظمة: ${org||'-'}\nالبريد: ${email}\nالهاتف: ${phone||'-'}\nنوع الشراكة: ${type}\n\nالرسالة:\n${msg||'-'}\n`;
  const mailto=`mailto:partnerships@example.com?subject=${encodeURIComponent('انضمام كشريك - منصّة زد إيمانك')}&body=${encodeURIComponent(body)}`;
  window.location.href=mailto;partnerModal.close();alert('تم إعداد رسالة البريد.');
}
function toggleFloatPartner(show){const b=document.getElementById('floatPartnerBtn');b.style.display=window.matchMedia('(max-width: 1000px)').matches&&(show)?'inline-flex':'none';}

/* Theme toggle */
document.getElementById('themeBtn').addEventListener('click',()=>{
  document.documentElement.classList.toggle('force-dark');
  document.documentElement.style.colorScheme=document.documentElement.classList.contains('force-dark')?'dark':'light';
});

/* Init */
document.getElementById('year').textContent=new Date().getFullYear();
(function initialDeep(){const full=location.hash||"#/";if(full.includes('#/')){const p=full.split('#/');if(p[1]?.includes('#')) sessionStorage.setItem('pendingAnchor','#'+p[1].split('#')[1]);}})();
route(); drawRadar(); refreshAll(); randomAyah(); fillHawkinsTable();
</script>
</body>
</html>
