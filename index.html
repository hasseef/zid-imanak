<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
<title>منصة زد إيمانك — تطبيق تأمّلي تفاعلي</title>
<meta name="description" content="منصّة هادئة لتعزيز الإيمان عبر الأسماء الحسنى، ربط التقدّم بسُلّم هاوكنز وهرم ماسلو، وبناء خطة 14 يومًا مدعومة بآيات وتمارين نفسية."/>
<meta name="theme-color" content="#0f6781"/>
<link id="manifestLink" rel="manifest"/>
<link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Tajawal:wght@400;700;800&display=swap" rel="stylesheet">
<meta property="og:title" content="منصة زد إيمانك"/>
<meta property="og:description" content="قيّم إيمانك، اكتشف مستوى وعيك، وابنِ خطة 14 يومًا"/>
<meta property="og:type" content="website"/>
<meta name="twitter:card" content="summary"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
<style>
:root{--blue:#0f6781;--blue2:#2a7c92;--beige:#efe9dc;--gold:#d4a944;--ink:#0f1a20;--muted:#5c6a7a;--card:#ffffff;--border:#e6ecf2;--badge:#f7fafc;--bg:#ffffff;--bg2:#f7f5ef}
@media (prefers-color-scheme: dark){:root{--bg:#0b1216;--bg2:#0e161b;--card:#101a20;--ink:#e9eef2;--muted:#a7b3bf;--border:#1f2a33;--badge:#0f1a21}}
*{box-sizing:border-box}html,body{margin:0;height:100%}
body{font-family:system-ui,-apple-system,"Tajawal","Noto Kufi Arabic",Segoe UI,Roboto,sans-serif;color:var(--ink);background:
radial-gradient(1200px 400px at 90% -10%, rgba(212,169,68,.10), transparent),
radial-gradient(900px 500px at 10% -20%, rgba(15,103,129,.12), transparent),
linear-gradient(180deg,var(--bg2) 0%,var(--bg) 60%,var(--bg2) 100%);}
.container{max-width:1200px;margin:0 auto;padding:14px}a{color:inherit;text-decoration:none}
:focus-visible{outline:2px solid var(--gold);outline-offset:2px}

/* Skip link */
.skip a{position:absolute;left:-9999px;top:auto;width:1px;height:1px;overflow:hidden}
.skip a:focus{left:12px;top:12px;width:auto;height:auto;background:#fff;padding:8px 12px;border-radius:10px;border:1px solid var(--border);z-index:1000}

/* Header */
.header{position:sticky;top:0;z-index:40;backdrop-filter:blur(10px);background:rgba(255,255,255,.75);border-bottom:1px solid var(--border)}
@media (prefers-color-scheme: dark){.header{background:rgba(16,26,32,.6)}}
.header-inner{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 0}
/* RIGHT: brand + nav */
.brand{display:flex;align-items:center;gap:12px;min-width:0}
.app-logo-wrap{display:flex;flex-direction:column;align-items:center;gap:4px}
.app-logo{width:56px;height:56px;border-radius:14px;background:var(--badge);border:1px solid var(--border);display:grid;place-items:center;padding:6px}
.app-logo svg{width:100%;height:100%}
.app-name{font-weight:800;font-size:12px;color:var(--ink);letter-spacing:.5px}
.nav{display:flex;gap:6px;flex-wrap:wrap}
.nav a{padding:10px 12px;border-radius:12px;border:1px solid transparent}
.nav a:hover,.nav a.active{background:rgba(0,0,0,.05);border-color:var(--border)}
.theme-toggle{border:1px solid var(--border);background:var(--card);border-radius:10px;padding:8px 10px;line-height:0}
.hamburger{display:none;border:1px solid var(--border);background:var(--card);border-radius:10px;padding:10px;line-height:0}
/* LEFT: Vision + Talbiya + audio */
.left-logos{display:flex;align-items:center;gap:10px;min-width:0}
.logo{display:inline-flex;align-items:center;justify-content:center;border:1px solid var(--border);border-radius:12px;background:var(--badge);padding:6px;height:38px}
.logo img,.logo svg{max-height:100%;max-width:100%;object-fit:contain}
.audio-btn{border:1px solid var(--border);padding:8px 12px;border-radius:10px;background:var(--card)}

/* Layout */
main{padding-bottom:90px}.section{margin-top:16px}
.card{background:var(--card);border:1px solid var(--border);border-radius:18px;padding:14px}
.shadow{box-shadow:0 10px 30px rgba(0,0,0,.06)}
.grid{display:grid;gap:12px}.cols-2{grid-template-columns:1fr 1fr}.cols-3{grid-template-columns:repeat(3,1fr)}
@media(max-width:980px){.cols-2,.cols-3{grid-template-columns:1fr}}

/* Hero */
.hero{display:grid;gap:16px;grid-template-columns:1.1fr 1fr;align-items:center;padding:16px;border:1px solid var(--border);border-radius:24px;background:linear-gradient(135deg,#0f6781 0%,#2a7c92 60%,rgba(212,169,68,.45) 100%);color:#fff}
.hero h1{margin:0 0 10px;font-size:28px}.hero p{margin:0;color:#eaf7ff}
.hero .btns{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
.btn{border:none;border-radius:12px;padding:12px 14px;font-weight:800;cursor:pointer}
.btn-primary{background:var(--gold);color:#1a2228}.btn-primary:hover{background:#c79b34}
.btn-ghost{background:transparent;border:1px dashed var(--border);color:#fff}
.verse-box{background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.25);border-radius:18px;padding:16px;text-align:center;font-family:"Amiri","Scheherazade New",serif}
.verse-box .ayah{font-size:22px;line-height:1.9}
.kpis{display:flex;gap:10px;flex-wrap:wrap}
.kpi{flex:1 1 180px;background:#ffffff1a;border:1px solid rgba(255,255,255,.35);border-radius:12px;padding:10px}.kpi b{display:block;font-size:18px}.kpi span{font-size:12px}
.input,select,textarea{width:100%;padding:14px 12px;border:1px solid var(--border);border-radius:14px;background:var(--card);color:var(--ink)}
.range{width:100%;height:34px}
.range::-webkit-slider-thumb{-webkit-appearance:none;width:28px;height:28px;border-radius:50%;background:var(--blue2);border:3px solid #fff;box-shadow:0 1px 4px rgba(0,0,0,.2)}
.range::-moz-range-thumb{width:28px;height:28px;border-radius:50%;background:var(--blue2);border:none}
.small{font-size:12px;color:var(--muted)}.badge{display:inline-block;padding:4px 10px;border-radius:999px;background:var(--badge);border:1px solid var(--border);font-size:12px}
.separator{height:1px;background:var(--border);margin:8px 0}.notice{padding:10px;border:1px solid var(--border);background:#fffdf5;border-radius:12px}
.radar{padding:10px;background:var(--card);border:1px solid var(--border);border-radius:16px}.table-wrap{overflow:auto;-webkit-overflow-scrolling:touch}
.table{width:100%;border-collapse:separate;border-spacing:0;min-width:520px}.table th,.table td{border:1px solid var(--border);padding:10px;border-left:none;border-top:none}
.table th:first-child,.table td:first-child{border-right:1px solid var(--border)}.table tr:last-child td{border-bottom:1px solid var(--border)}.table th{background:#f8fafc}

/* Animations */
@keyframes fadeUp { from{opacity:0; transform: translateY(12px);} to{opacity:1; transform: translateY(0);} }
.reveal>*{opacity:0; transform:translateY(12px)}
.reveal>.anim{animation: fadeUp .6s ease both}
.reveal .anim-1{animation-delay:.05s}.reveal .anim-2{animation-delay:.12s}.reveal .anim-3{animation-delay:.18s}.reveal .anim-4{animation-delay:.24s}.reveal .anim-5{animation-delay:.30s}
/* Drawer slide-in */
@keyframes slideIn { from{transform:translateX(12px);opacity:0} to{transform:translateX(0);opacity:1} }
.nav.open{animation:slideIn .25s ease both}
@media (prefers-reduced-motion: reduce){ .reveal>*{opacity:1;transform:none} .anim{animation:none} .nav.open{animation:none} }

/* Transition highlight (title flash) */
@keyframes goldFlash { 0%{box-shadow:0 0 0 rgba(212,169,68,0)} 100%{box-shadow:0 0 0 rgba(212,169,68,0)} }
.flash-gold{background:linear-gradient(90deg, rgba(212,169,68,.25), rgba(212,169,68,.05)); border-radius:10px; padding:3px 6px; animation: goldFlash .5s ease;}

/* Welcome bar */
.welcome-bar{position:sticky;top:64px;z-index:35;margin:0 14px 8px;border-radius:12px;border:1px solid rgba(212,169,68,.35);
 background:linear-gradient(90deg,rgba(212,169,68,.65),rgba(212,169,68,.45)); color:#fff; font-family:"Amiri",serif;
 text-align:center; padding:8px 12px; opacity:0; transform:translateY(-6px); pointer-events:none;
 text-shadow:0 1px 2px rgba(0,0,0,.25);}
.welcome-bar.show{opacity:1; transform:translateY(0); transition:opacity .25s ease, transform .25s ease;}
.welcome-bar.hide{opacity:0; transform:translateY(-6px); transition:opacity .3s ease, transform .3s ease;}

/* Footer */
.footer{text-align:center;color:var(--muted);font-size:12px;padding:20px 0;border-top:1px solid var(--border);background:rgba(255,255,255,.6)}

/* Mobile header/menu */
@media(max-width:840px){
  .app-logo{width:48px;height:48px;border-radius:12px}
  .logo{height:34px}
  .hamburger{display:inline-flex}
  .nav{display:none;position:fixed;right:12px;left:12px;top:68px;background:var(--card);border:1px solid var(--border);border-radius:14px;padding:8px;flex-direction:column;box-shadow:0 14px 40px rgba(0,0,0,.12)}
  .nav.open{display:flex}
}

/* Print (roadmap) */
@media print {
  header,.nav,.left-logos,.footer, .breadcrumbs, .btn, .welcome-bar {display:none !important}
  main {padding:0} .card {border:none} body {background:#fff;color:#000}
}

/* Modal (partners) */
dialog.partner-modal{border:none;border-radius:18px;max-width:560px;width:92vw;background:var(--card);color:var(--ink);box-shadow:0 20px 60px rgba(0,0,0,.25);padding:0}
.partner-modal::backdrop{background:rgba(0,0,0,.35)}
.modal-head{padding:14px 16px;border-bottom:1px solid var(--border);display:flex;align-items:center;justify-content:space-between}
.modal-body{padding:16px}
.modal-actions{display:flex;gap:8px;justify-content:flex-start;padding:12px 16px;border-top:1px solid var(--border)}
.close-btn{border:1px solid var(--border);background:var(--card);border-radius:10px;padding:8px 12px}
</style>
</head>
<body>
<div class="skip"><a href="#content">تجاوز إلى المحتوى</a></div>

<header class="header" role="banner">
  <div class="container header-inner">
    <!-- RIGHT: brand (app logo + nav) -->
    <div class="brand">
      <div class="app-logo-wrap">
        <div class="app-logo" title="منصة زد إيمانك" aria-label="شعار المنصة">
          <svg viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <defs><radialGradient id="g" cx="50%" cy="50%" r="60%">
              <stop offset="0%" stop-color="#FACC15" stop-opacity=".95"/>
              <stop offset="60%" stop-color="#60A5FA" stop-opacity=".9"/>
              <stop offset="100%" stop-color="#14B8A6" stop-opacity=".85"/>
            </radialGradient></defs>
            <rect width="256" height="256" rx="44" ry="44" fill="url(#g)"/>
            <circle cx="128" cy="128" r="86" fill="rgba(255,255,255,.15)"/>
            <text x="50%" y="57%" text-anchor="middle" font-family="Tajawal" font-size="120" fill="#0F172A">ز</text>
          </svg>
        </div>
        <div class="app-name">زد إيمانك</div>
      </div>
      <button id="menuBtn" class="hamburger" aria-label="القائمة">☰</button>
      <nav class="nav" id="nav" role="navigation" aria-label="القائمة الرئيسية"></nav>
      <button id="themeBtn" class="theme-toggle" title="الوضع الداكن/الفاتح" aria-label="تبديل الوضع">🌓</button>
    </div>

    <!-- LEFT: Vision 2030 + Talbiya (inline SVG placeholders) + audio -->
    <div class="left-logos">
      <div class="logo" title="Vision 2030">
        <!-- SVG placeholder for Vision 2030 -->
        <svg viewBox="0 0 180 44" aria-hidden="true"><rect x="0" y="0" width="180" height="44" rx="10" fill="#f7fafc" stroke="#e6ecf2"/>
          <text x="50%" y="60%" text-anchor="middle" font-family="Tajawal" font-weight="700" font-size="18" fill="#0f6781">VISION 2030</text>
        </svg>
      </div>
      <div class="logo" title="Talbiya">
        <!-- SVG placeholder for Talbiya -->
        <svg viewBox="0 0 120 44" aria-hidden="true"><rect x="0" y="0" width="120" height="44" rx="10" fill="#f7fafc" stroke="#e6ecf2"/>
          <text x="50%" y="60%" text-anchor="middle" font-family="Tajawal" font-weight="700" font-size="16" fill="#2a7c92">Talbiya</text>
        </svg>
      </div>
      <button id="audioBtn" class="audio-btn" aria-label="تشغيل التلاوة">🔊</button>
    </div>
  </div>
</header>

<!-- Welcome bar -->
<div id="welcomeBar" class="welcome-bar" role="status" aria-live="polite" style="display:none"></div>

<audio id="recitation" loop preload="auto">
  <!-- ضع ملف تلاوة إن رغبت -->
  <!-- <source src="abdulbasit.mp3" type="audio/mpeg"/> -->
</audio>

<main id="content" class="container" role="main">
  <section id="page-home" class="page" aria-labelledby="homeTitle">
    <div class="hero shadow reveal">
      <div class="anim anim-1">
        <h1 id="homeTitle">إيماني المعاصر — زد إيمانك</h1>
        <p>منصّة عملية تعزّز الإيمان عبر الأسماء الحسنى، وتربط تقدّمك بسُلّم هاوكنز، هرَم ماسلو، وعجلة الحياة — ثم تمنحك خطة 14 يومًا مستندة إلى آيات وحكمة نفسية.</p>
        <div class="btns anim anim-2">
          <a class="btn btn-primary" href="#/assessment">ابدأ التقييم الآن</a>
          <a class="btn btn-ghost" href="#/vision2030">الارتباط برؤية 2030</a>
        </div>
        <div class="kpis" style="margin-top:12px">
          <div class="kpi anim anim-3"><b id="kpiFaith">—%</b><span>نسبة الإيمان (متوسط الأسماء)</span></div>
          <div class="kpi anim anim-4"><b id="kpiHawkins">—</b><span>مستوى سُلّم هاوكنز</span></div>
          <div class="kpi anim anim-5"><b id="kpiMaslow">—</b><span>طبقة ماسلو الحالية</span></div>
        </div>
      </div>
      <div class="verse-box anim anim-2"><div class="ayah">﴿وَلِلَّهِ الأَسْمَاءُ الْحُسْنَى فَادْعُوهُ بِهَا﴾</div><div class="small">الأعراف: 180</div></div>
    </div>

    <div class="section grid cols-2 reveal">
      <div class="card anim anim-1">
        <h3>كيف يعمل؟</h3>
        <ol class="small" style="line-height:1.9;padding-right:18px">
          <li>قيّم عمق إيمانك (0–100) في <b>الأسماء الحسنى</b> المختارة.</li>
          <li>نحتسب المتوسط ونُسقِطه على <b>سُلّم هاوكنز</b> ونحدّد طبقة <b>ماسلو</b>.</li>
          <li>املأ <b>عجلة الحياة</b> (8 جوانب) فتُبنى <b>خريطة طريق</b> من 14 يومًا بآيات وتمارين نفسية.</li>
        </ol>
      </div>
      <div class="card anim anim-2">
        <h3>عجلة الحياة</h3>
        <div class="radar"><canvas id="radar" height="260" aria-label="رسم راداري لعجلة الحياة" role="img"></canvas></div>
        <div class="small" style="margin-top:6px;color:var(--muted)">عدّل القيم من صفحة “التقييم” لترى التغيّر فورًا.</div>
      </div>
    </div>
  </section>

  <section id="page-assessment" class="page hide" aria-labelledby="assessTitle">
    <div class="reveal">
      <nav class="breadcrumbs anim anim-1"><a href="#/">الرئيسية</a><span class="dot"></span><b id="assessTitle">التقييم الإيماني</b></nav>
      <div class="grid cols-2">
        <div class="card anim anim-2">
          <h3 class="title-flash-target">١) تقييم الأسماء الحسنى (بحث + ٩٩ اسمًا)</h3>
          <div style="display:flex;gap:8px;align-items:center;margin:6px 0">
            <input id="searchName" class="input" placeholder="ابحث عن اسم (مثال: الشافي، الحكيم، الرزّاق)" aria-label="ابحث عن اسم من الأسماء الحسنى"/><span class="badge">اختر وقيّم 0–100</span>
          </div>
          <div id="namesWrap" class="grid cols-2" style="margin-top:8px;max-height:420px;overflow:auto"></div>
          <div class="separator"></div>
          <button class="btn btn-primary" onclick="saveNames()">حفظ التقييم</button>
          <button class="btn" onclick="exportData()">تصدير البيانات</button>
          <label class="btn" for="importFile" style="cursor:pointer">استيراد</label>
          <input id="importFile" type="file" accept="application/json" style="display:none" onchange="importData(event)"/>
        </div>
        <div class="card anim anim-3">
          <h3>٢) عجلة الحياة (٨ جوانب)</h3>
          <p class="small" style="color:var(--muted)">قيّم رضاك الحالي (0–10) في كل جانب.</p>
          <div id="lifeWrap" class="grid cols-2" style="margin-top:8px"></div>
          <div class="separator"></div>
          <button class="btn btn-primary" onclick="saveLife()">حفظ العجلة</button>
          <button class="btn" onclick="shareProgress()">مشاركة تقدمي</button>
        </div>
      </div>

      <div class="section grid cols-3">
        <div class="card anim anim-1">
          <h3>٣) النتائج الفورية</h3>
          <div class="kpis">
            <div class="kpi"><b id="faithPct">—%</b><span>نسبة الإيمان العامة</span></div>
            <div class="kpi"><b id="hawkinsLevel">—</b><span>مستوى هاوكنز</span></div>
            <div class="kpi"><b id="maslowTier">—</b><span>طبقة ماسلو</span></div>
          </div>
          <p class="small" id="levelBlurb" style="margin-top:8px;color:var(--muted)"></p>
        </div>

        <div class="card anim anim-2">
          <h3>٤) سُلّم هاوكنز (توضيح)</h3>
          <div class="table-wrap">
            <table class="table small"><thead><tr><th>النطاق</th><th>الشعور السائد</th><th>القيمة</th><th>وصف وتوصية</th></tr></thead><tbody id="hawkinsTable"></tbody></table>
          </div>
        </div>

        <div class="card anim anim-3">
          <h3>٥) هرم ماسلو (توضيح)</h3>
          <div class="table-wrap">
            <table class="table small">
              <thead><tr><th>الطبقة</th><th>الوصف</th><th>تطبيق عملي</th></tr></thead>
              <tbody id="maslowTable">
                <tr><td>فسيولوجي</td><td>طعام، نوم، صحة</td><td>تنظيم النوم والغذاء</td></tr>
                <tr><td>أمان</td><td>استقرار، مال، سكن</td><td>ميزانية أسبوعية وروتين</td></tr>
                <tr><td>انتماء</td><td>علاقات، محبّة</td><td>صلة رحم وصحبة صالحة</td></tr>
                <tr><td>تقدير</td><td>إنجاز، ثقة</td><td>هدف صغير متحقق يوميًا</td></tr>
                <tr><td>تحقيق الذات</td><td>شغف، معنى</td><td>خدمة الآخرين/تعلّم مؤثر</td></tr>
                <tr><td>السموّ بالإيمان</td><td>وعي روحي</td><td>خلوة وذكر وتدبر</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="section"><a class="btn btn-primary anim anim-1" href="#/roadmap">خريطة الطريق (١٤ يومًا)</a></div>
    </div>
  </section>

  <section id="page-roadmap" class="page hide" aria-labelledby="roadTitle">
    <div class="reveal">
      <nav class="breadcrumbs anim anim-1"><a href="#/">الرئيسية</a><span class="dot"></span><b id="roadTitle">خريطة الطريق</b></nav>
      <div class="card anim anim-2">
        <h3 class="title-flash-target">خطة شخصية لمدة ١٤ يومًا</h3>
        <p class="small" style="color:var(--muted)">مبنية على نسبة الإيمان، مستوى هاوكنز، طبقة ماسلو، وعجلة الحياة.</p>
        <div id="roadmapPlan" class="grid" style="margin-top:8px"></div>
        <div class="separator"></div>
        <button class="btn btn-primary" onclick="downloadPlan()">حفظ كملف HTML</button>
        <button class="btn btn-ghost" onclick="window.print()">طباعة</button>
      </div>
    </div>
  </section>

  <section id="page-vision2030" class="page hide" aria-labelledby="vTitle">
    <div class="reveal">
      <nav class="breadcrumbs anim anim-1"><a href="#/">الرئيسية</a><span class="dot"></span><b id="vTitle">الارتباط برؤية 2030</b></nav>
      <div class="grid cols-2">
        <div class="card anim anim-2">
          <h3 class="title-flash-target">محاور الانسجام</h3>
          <ul class="small" style="line-height:1.9;padding-right:18px">
            <li><b>تعزيز القيم الإسلامية والهوية الوطنية</b> — الوسطية/التسامح/الإتقان/العدالة/المثابرة.</li>
            <li><b>تمكين حياة عامرة وصحية</b> — نمط صحي، جودة الحياة، الوقاية، ثقافة وترفيه هادف.</li>
            <li><b>تمكين المسؤولية الاجتماعية</b> — أثر غير ربحي وتمكين للفرد والمنظمة.</li>
          </ul>
        </div>
        <div class="card anim anim-3">
          <h3>مؤشرات قابلة للقياس</h3>
          <ul class="small" style="line-height:1.9;padding-right:18px">
            <li>تحسّن ثلاثة جوانب على الأقل في عجلة الحياة.</li>
            <li>ارتفاع “نسبة الإيمان” ≥ عشر نقاط خلال دورة.</li>
            <li>الانتقال مستوى واحدًا على الأقل على سُلّم هاوكنز.</li>
          </ul>
          <div class="notice small">إمكانية ربط المؤشرات ببرامج التطوع وجودة الحياة محليًا.</div>
        </div>
      </div>
    </div>
  </section>

  <section id="page-partners" class="page hide" aria-labelledby="pTitle">
    <div class="reveal">
      <nav class="breadcrumbs anim anim-1"><a href="#/">الرئيسية</a><span class="dot"></span><b id="pTitle">شركاؤنا</b></nav>
      <div class="card anim anim-2" style="text-align:center">
        <h3 class="title-flash-target" style="margin:0 0 8px">دعوة للشراكة</h3>
        <p class="small" style="color:var(--muted);margin:0 0 10px">
          انضمّ إلى شركاء الإيمان والتنمية؛ كن جزءًا من أثرٍ مستدام يدعم مشاريع المنصّة ويُمكّن الوعي الروحي والمجتمعي.
        </p>
        <button class="btn btn-primary" onclick="openPartnerForm()">انضمّ كشريك</button>
      </div>
      <div class="card anim anim-3">
        <h3>الشركاء والداعمون</h3>
        <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:12px;max-width:100%">
          <div class="logo" title="مبادرة تلبية">
            <!-- يمكن استبدال هذا بـ Base64 للشعار الحقيقي -->
            <svg viewBox="0 0 120 44"><rect width="120" height="44" rx="10" fill="#f7fafc" stroke="#e6ecf2"/>
              <text x="50%" y="60%" text-anchor="middle" font-family="Tajawal" font-weight="700" font-size="16" fill="#2a7c92">مبادرة تلبية</text>
            </svg>
          </div>
          <div class="logo" title="شركة تلبية">
            <svg viewBox="0 0 120 44"><rect width="120" height="44" rx="10" fill="#f7fafc" stroke="#e6ecf2"/>
              <text x="50%" y="60%" text-anchor="middle" font-family="Tajawal" font-weight="700" font-size="16" fill="#0f6781">شركة تلبية</text>
            </svg>
          </div>
          <div class="logo"><span style="color:#64748b;font-weight:700">Partner</span></div>
        </div>
      </div>
    </div>
  </section>

  <section id="page-about" class="page hide" aria-labelledby="aTitle">
    <div class="reveal">
      <nav class="breadcrumbs anim anim-1"><a href="#/">الرئيسية</a><span class="dot"></span><b id="aTitle">عن المنصة</b></nav>
      <div class="card anim anim-2">
        <h3 class="title-flash-target">عن منصة زد إيمانك</h3>
        <p class="small" style="color:var(--muted)">
          منصّة رقمية تأمّلية وتنموية تعزّز الإيمان بالله عبر التفاعل مع الأسماء الحسنى وتطبيقاتها العملية، مستندةً إلى مبادئ علم النفس الإيجابي،
          وسُلّم هاوكنز لمستويات الوعي، وهرم ماسلو للاحتياجات؛ لتزويدك بخريطة طريق عملية تُحسّن جودة حياتك روحانيًا ونفسيًا وسلوكيًا.
        </p>
        <h4>الرؤية</h4>
        <p class="small">أن تكون المنصّة المرجع الرقمي الأوّل لتطوير الإيمان الواعي في العالم العربي.</p>
        <h4>الرسالة</h4>
        <p class="small">تمكين الأفراد من بناء توازن روحاني ونفسي وسلوكي عبر تقييمٍ وتأمّلٍ وخططٍ تنمويةٍ تستند إلى القيم القرآنية والعلمية.</p>
        <h4>الأهداف</h4>
        <ul class="small" style="line-height:1.9;padding-right:18px">
          <li>ربط الإيمان بالوعي والسلوك اليومي بصورةٍ علميةٍ وروحيةٍ.</li>
          <li>تعريف المستخدم بمستوى وعيه وفق سُلّم هاوكنز وإضاءاتٍ عمليةٍ.</li>
          <li>تحقيق التوازن عبر طبقات هرم ماسلو وجوانب عجلة الحياة.</li>
          <li>تقديم خطط ١٤ يومًا قابلةٍ للقياس ومدعومةٍ بآياتٍ وتمارينَ نفسيةٍ.</li>
          <li>الإسهام في مستهدفات رؤية 2030: جودة الحياة وتعزيز القيم الإسلامية.</li>
        </ul>
      </div>
    </div>
  </section>
</main>

<footer class="footer" role="contentinfo">© جميع الحقوق محفوظة لشركة <b>تلبية للبحث والتطوير</b> — <span id="year"></span></footer>

<!-- Partner modal -->
<dialog class="partner-modal" id="partnerModal">
  <form method="dialog">
    <div class="modal-head">
      <b>نموذج انضمام الشركاء</b>
      <button class="close-btn" onclick="partnerModal.close()">إغلاق</button>
    </div>
    <div class="modal-body">
      <div class="grid cols-2">
        <label class="card"><span class="small">الاسم الكامل</span><input id="pf_name" class="input" required/></label>
        <label class="card"><span class="small">المنظمة/الجهة</span><input id="pf_org" class="input"/></label>
      </div>
      <div class="grid cols-2" style="margin-top:8px">
        <label class="card"><span class="small">البريد الإلكتروني</span><input id="pf_email" type="email" class="input" required/></label>
        <label class="card"><span class="small">الهاتف (اختياري)</span><input id="pf_phone" class="input"/></label>
      </div>

      <!-- New dropdown (required) -->
      <div class="grid" style="margin-top:8px">
        <label class="card">
          <span class="small">نوع الشراكة</span>
          <select id="pf_type" class="input" required>
            <option value="" selected disabled>اختر النوع</option>
            <option>مالية</option>
            <option>علمية</option>
            <option>إعلامية</option>
            <option>تقنية</option>
            <option>أخرى</option>
          </select>
        </label>
      </div>

      <label class="card" style="margin-top:8px"><span class="small">رسالة/اهتمام</span><textarea id="pf_msg" class="input" rows="4" placeholder="عرّف بنا وبمجال الشراكة المرغوب"></textarea></label>
      <div class="notice small" style="margin-top:8px">سيتم إنشاء بريد مسودّة تلقائيًا بالبيانات لإرساله لنا.</div>
    </div>
    <div class="modal-actions">
      <button class="btn btn-primary" onclick="submitPartnerForm()">إرسال</button>
      <button class="btn" type="reset">تفريغ</button>
    </div>
  </form>
</dialog>

<script>
/* Manifest + SW with offline fallback */
const OFFLINE_HTML = `<!doctype html><meta charset="utf-8"><title>وضع عدم الاتصال</title><style>body{font-family:system-ui,"Tajawal";direction:rtl;padding:20px}</style><h2>أنت غير متصل</h2><p>يمكنك استخدام الأجزاء المحفوظة مسبقًا من المنصة، وسيتم تحديثها عند عودة الاتصال.</p>`;
const manifest={"name":"منصة زد إيمانك","short_name":"زد إيمانك","start_url":"./?pwa=true","display":"standalone","lang":"ar","dir":"rtl","theme_color":"#0f6781","background_color":"#ffffff","icons":[
  {"src":"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 128 128'><rect rx='28' ry='28' width='128' height='128' fill='%230f6781'/><text x='64' y='84' text-anchor='middle' font-size='84' fill='white'>ز</text></svg>","sizes":"128x128","type":"image/svg+xml"},
  {"src":"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect rx='80' ry='80' width='512' height='512' fill='%230f6781'/><text x='256' y='320' text-anchor='middle' font-size='300' fill='white'>ز</text></svg>","sizes":"512x512","type":"image/svg+xml","purpose":"maskable any"}
]};
(function attachManifest(){
  const link=document.getElementById('manifestLink');
  const url=URL.createObjectURL(new Blob([JSON.stringify(manifest)],{type:'application/manifest+json'}));
  link.href=url;
})();
(function registerSW(){
  if('serviceWorker' in navigator){
    const sw = `const CACHE='iman-v3';let OFFLINE_URL='offline.html';self.addEventListener('install',e=>{e.waitUntil((async()=>{const c=await caches.open(CACHE);await c.addAll(['./',OFFLINE_URL]);})());self.skipWaiting();});self.addEventListener('activate',e=>self.clients.claim());self.addEventListener('fetch',e=>{e.respondWith((async()=>{try{const r=await fetch(e.request);const c=await caches.open(CACHE);c.put(e.request,r.clone());return r;}catch(err){const m=await caches.match(e.request);return m||caches.match(OFFLINE_URL);}})());});`;
    const offlineUrl = URL.createObjectURL(new Blob([OFFLINE_HTML],{type:'text/html'}));
    const swUrl = URL.createObjectURL(new Blob([sw.replace("OFFLINE_URL='offline.html'","OFFLINE_URL='"+offlineUrl+"'")],{type:'text/javascript'}));
    navigator.serviceWorker.register(swUrl);
  }
})();

/* Install prompt */
let deferredPrompt;window.addEventListener('beforeinstallprompt',(e)=>{e.preventDefault();deferredPrompt=e;const install=document.createElement('button');install.textContent='📲 تثبيت التطبيق';install.className='btn';install.style.marginRight='8px';document.querySelector('.btns')?.prepend(install);install.addEventListener('click',async()=>{install.disabled=true;try{await deferredPrompt.prompt();}catch{}});});

/* Theme toggle */
const themeBtn=document.getElementById('themeBtn');themeBtn.addEventListener('click',()=>{document.documentElement.classList.toggle('force-dark');if(document.documentElement.classList.contains('force-dark')){document.documentElement.style.colorScheme='dark';}else{document.documentElement.style.colorScheme='light';}});

/* Build navigation */
const routes=[
  {hash:"#/",label:"الرئيسية", welcome:"مرحبًا بك في الصفحة الرئيسية"},
  {hash:"#/assessment",label:"التقييم", welcome:"مرحبًا بك في صفحة التقييم"},
  {hash:"#/roadmap",label:"خريطة الطريق", welcome:"مرحبًا بك في صفحة خريطة الطريق"},
  {hash:"#/vision2030",label:"الارتباط برؤية 2030", welcome:"مرحبًا بك في صفحة رؤية 2030"},
  {hash:"#/partners",label:"شركاؤنا", welcome:"مرحبًا بك في صفحة الشركاء"},
  {hash:"#/about",label:"عن المنصة", welcome:"مرحبًا بك في صفحة عن المنصة"}
];
const nav=document.getElementById('nav');
routes.forEach(r=>{const a=document.createElement('a');a.href=r.hash;a.textContent=r.label;a.setAttribute('data-route','');nav.appendChild(a);});
const menuBtn=document.getElementById('menuBtn');menuBtn.addEventListener('click',()=>{nav.classList.toggle('open');});
document.addEventListener('click',(e)=>{if(!nav.contains(e.target) && e.target!==menuBtn) nav.classList.remove('open');},{passive:true});

/* Router + page animation trigger + aria-current + welcome bar + title flash */
const welcomeBar=document.getElementById('welcomeBar');
function showWelcome(text){
  if(!welcomeBar) return;
  welcomeBar.textContent=text;
  welcomeBar.style.display='block';
  welcomeBar.classList.remove('hide');
  requestAnimationFrame(()=>welcomeBar.classList.add('show'));
  setTimeout(()=>{welcomeBar.classList.remove('show');welcomeBar.classList.add('hide');}, 2000);
  setTimeout(()=>{welcomeBar.style.display='none';welcomeBar.classList.remove('hide');}, 2400);
}
function flashTitle(){
  const page=document.querySelector('.page:not(.hide)');
  const target=page?.querySelector('.title-flash-target') || page?.querySelector('h1, h3');
  if(!target) return;
  target.classList.add('flash-gold');
  setTimeout(()=>target.classList.remove('flash-gold'), 500);
}
function applyReveal(){
  const page=document.querySelector('.page:not(.hide) .reveal');
  if(!page) return;
  [...page.children].forEach((c,i)=>{ if(!c.classList.contains('anim')) c.classList.add('anim'); c.style.animationDelay = (0.06*i)+'s'; });
  page.classList.remove('reveal'); void page.offsetWidth; page.classList.add('reveal');
  [...page.querySelectorAll('.anim')].forEach(el=>{ el.style.animation='fadeUp .6s ease both'; });
}
function route(){
  const h=location.hash||"#/";
  document.querySelectorAll('.page').forEach(p=>p.classList.add('hide'));
  const id=h==="#/"?"page-home":h==="#/assessment"?"page-assessment":h==="#/roadmap"?"page-roadmap":h==="#/vision2030"?"page-vision2030":h==="#/partners"?"page-partners":"page-about";
  document.getElementById(id).classList.remove('hide');
  document.querySelectorAll('[data-route]').forEach(a=>{a.classList.toggle('active',a.getAttribute('href')===h); if(a.getAttribute('href')===h) a.setAttribute('aria-current','page'); else a.removeAttribute('aria-current');});
  nav.classList.remove('open');
  const r=routes.find(x=>x.hash===h)||routes[0];
  showWelcome(r.welcome);
  if(h==="#/assessment"){buildNames();buildLife();randomAyah();fillHawkinsTable();setTimeout(fillHawkinsBar,0);}
  if(h==="#/roadmap"){renderRoadmap();}
  if(h!=="#/"){audioPauseSoft();}
  window.scrollTo({top:0,behavior:'smooth'});
  applyReveal();
  flashTitle();
}
window.addEventListener('hashchange',route);

/* Audio */
const audio=document.getElementById('recitation');const audioBtn=document.getElementById('audioBtn');let audioOn=false;
function audioPauseSoft(){if(!audio.paused){audio.pause();audioOn=false;audioBtn.textContent='🔊';}}
audioBtn.addEventListener('click', async ()=>{try{if(!audioOn){await audio.play();audioOn=true;audioBtn.textContent='⏸';}else{audio.pause();audioOn=false;audioBtn.textContent='🔊';}}catch(e){}}, {passive:true});

/* Gentle UI sound via WebAudio */
function uiPing(){
  try{
    const ctx=new (window.AudioContext||window.webkitAudioContext)();
    const o=ctx.createOscillator();const g=ctx.createGain();
    o.type='sine';o.frequency.value=660;g.gain.value=0.0001;
    o.connect(g);g.connect(ctx.destination);
    o.start();g.gain.exponentialRampToValueAtTime(0.06, ctx.currentTime+0.12);
    setTimeout(()=>{o.stop();ctx.close();},160);
  }catch(_){}
}

/* Data + helpers */
const NAMES_99=["الله","الرحمن","الرحيم","الملك","القدوس","السلام","المؤمن","المهيمن","العزيز","الجبار","المتكبر","الخالق","البارئ","المصور","الغفار","القهار","الوهاب","الرزاق","الفتاح","العليم","القابض","الباسط","الخافض","الرافع","المعز","المذل","السميع","البصير","الحكم","العدل","اللطيف","الخبير","الحليم","العظيم","الغفور","الشكور","العلي","الكبير","الحفيظ","المقيت","الحسيب","الجليل","الكريم","الرقيب","المجيب","الواسع","الحكيم","الودود","المجيد","الباعث","الشهيد","الحق","الوكيل","القوي","المتين","الولي","الحميد","المحصي","المبدئ","المعيد","المحيي","المميت","الحي","القيوم","الواجد","الماجد","الواحد","الأحد","الصمد","القادر","المقتدر","المقدم","المؤخر","الأول","الآخر","الظاهر","الباطن","الوالي","المتعالي","البر","التواب","المنتقم","العفو","الرؤوف","مالك الملك","ذو الجلال والإكرام","المقسط","الجامع","الغني","المغني","المانع","الضار","النافع","النور","الهادي","البديع","الباقي","الوارث","الرشيد","الصبور","الشافي"];
const LIFE_AREAS=["الإيمان/الروح","الصحة","العائلة","العلاقات","العمل/المال","العلم/التعلم","العطاء/الأثر","الهوايات/المتعة"];
const K={names:"iman_names",life:"iman_life"};function load(k){try{return JSON.parse(localStorage.getItem(k))}catch{return null)}
function save(k,v){localStorage.setItem(k,JSON.stringify(v));}
let namesScores=load(K.names)||Object.fromEntries(NAMES_99.map(n=>[n,50]));let lifeScores=load(K.life)||Object.fromEntries(LIFE_AREAS.map(n=>[n,5]));
function byId(id){return document.getElementById(id)}function el(tag,attrs={},children=[]){const e=document.createElement(tag);Object.entries(attrs).forEach(([k,v])=>{if(k==="class")e.className=v;else if(k==="html")e.innerHTML=v;else e.setAttribute(k,v);});(Array.isArray(children)?children:[children]).filter(Boolean).forEach(c=>e.appendChild(c));return e;}
function avg(vals){return vals.reduce((a,b)=>a+b,0)/Math.max(vals.length,1);}

/* Names UI */
function buildNames(){const wrap=byId('namesWrap');wrap.innerHTML="";const q=(byId('searchName').value||"").trim();const list=q?NAMES_99.filter(n=>n.includes(q)):NAMES_99;list.forEach(name=>{const val=namesScores[name]??50;wrap.appendChild(el("div",{class:"card anim"},[el("div",{html:`<b>${name}</b> <span class='badge' style='float:left'>${val}%</span>`}),el("input",{type:"range",min:"0",max:"100",value:String(val),class:"range",oninput:`updateName('${name}', this.value, this.previousElementSibling.querySelector('.badge'))`})]));});}
document.getElementById('searchName')?.addEventListener('input',buildNames,{passive:true});
function updateName(name,val,b){namesScores[name]=Number(val);b.textContent=val+"%";}
function saveNames(){save(K.names,namesScores);refreshAll();uiPing();alert("تم حفظ تقييم الأسماء.");}

/* Export/Import */
function exportData(){const data={names:namesScores,life:lifeScores};const blob=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download='iman-data.json';a.click();}
function importData(e){const f=e.target.files?.[0];if(!f)return;const r=new FileReader();r.onload=()=>{try{const obj=JSON.parse(r.result);if(obj.names)namesScores=obj.names;if(obj.life)lifeScores=obj.life;save(K.names,namesScores);save(K.life,lifeScores);buildNames();buildLife();drawRadar();refreshAll();alert("تم الاستيراد بنجاح.");}catch{alert("ملف غير صالح.");}};r.readAsText(f);}

/* Life Wheel */
function buildLife(){const wrap=byId('lifeWrap');wrap.innerHTML="";LIFE_AREAS.forEach(area=>{const val=lifeScores[area]??5;wrap.appendChild(el("div",{class:"card anim"},[el("div",{html:`<b>${area}</b> <span class='badge' style='float:left'>${val}/10</span>`}),el("input",{type:"range",min:"0",max:"10",value:String(val),class:"range",oninput:`updateLife('${area}', this.value, this.previousElementSibling.querySelector('.badge'))`})]));});}
function updateLife(area,val,b){lifeScores[area]=Number(val);b.textContent=val+"/10";}
function saveLife(){save(K.life,lifeScores);drawRadar();refreshAll();uiPing();alert("تم حفظ عجلة الحياة.");}

/* Hawkins / Maslow */
const HAWK_MAP=[
  {range:"0–20",label:"خزي/عار",code:20,note:"بدء قبول الذات والرحمة",color:"#ef4444"},
  {range:"20–35",label:"ذنب/أسى",code:75,note:"توبة + امتنان يومي",color:"#f97316"},
  {range:"35–50",label:"خوف/قلق",code:100,note:"توكّل عملي",color:"#f59e0b"},
  {range:"50–60",label:"شجاعة",code:200,note:"عادة صغيرة مستمرة",color:"#84cc16"},
  {range:"60–70",label:"قبول/حياد",code:300,note:"اتزان وروتين ذكر",color:"#22c55e"},
  {range:"70–80",label:"محبّة/بهجة",code:500,note:"تكثير العطاء",color:"#10b981"},
  {range:"80–90",label:"سلام",code:600,note:"خلوة وتدبر",color:"#06b6d4"},
  {range:"90–100",label:"نور/سكون",code:700,note:"صفاء وخدمة بإخلاص",color:"#6366f1"}
];
function fillHawkinsTable(){const tbody=byId('hawkinsTable');tbody.innerHTML="";HAWK_MAP.forEach(row=>{const tr=document.createElement('tr');tr.innerHTML=`<td>${row.range}</td><td>${row.label}</td><td>${row.code}</td><td>${row.note}</td>`;tbody.appendChild(tr);});}
function computeFaithPct(){return Math.round(avg(Object.values(namesScores)));}
function computeLifeAvg(){return avg(Object.values(lifeScores));}
function mapHawkins(pct){if(pct<20)return HAWK_MAP[0];if(pct<35)return HAWK_MAP[1];if(pct<50)return HAWK_MAP[2];if(pct<60)return HAWK_MAP[3];if(pct<70)return HAWK_MAP[4];if(pct<80)return HAWK_MAP[5];if(pct<90)return HAWK_MAP[6];return HAWK_MAP[7];}
function mapMaslow(avg10){if(avg10<3)return "فسيولوجي/أمان";if(avg10<5)return "انتماء/علاقات";if(avg10<7)return "تقدير/إنجاز";return "تحقيق الذات (+ السموّ بالإيمان)";}
function refreshAll(){const pct=computeFaithPct();const haw=mapHawkins(pct);const lifeAvg=computeLifeAvg();const mas=mapMaslow(lifeAvg);byId('kpiFaith').textContent=pct+"%";byId('kpiHawkins').textContent=`${haw.label} (${haw.code})`;byId('kpiMaslow').textContent=mas;byId('faithPct').textContent=pct+"%";byId('hawkinsLevel').textContent=`${haw.label} (${haw.code})`;byId('maslowTier').textContent=mas;byId('levelBlurb').textContent=`نبرة الوعي: ${haw.label} — توصية: ${haw.note}`; }

/* Ayat */
const AYAT=[
  {text:"﴿وَمَن يَتَوَكَّلْ عَلَى اللَّهِ فَهُوَ حَسْبُهُ﴾",ref:"الطلاق: 3"},
  {text:"﴿إِنَّ مَعَ الْعُسْرِ يُسْرًا﴾",ref:"الشرح: 6"},
  {text:"﴿قُلْ يَا عِبَادِيَ الَّذِينَ أَسْرَفُوا...﴾",ref:"الزمر: 53"},
  {text:"﴿ادْعُونِي أَسْتَجِبْ لَكُمْ﴾",ref:"غافر: 60"},
  {text:"﴿وَقُل رَّبِّ زِدْنِي عِلْمًا﴾",ref:"طه: 114"}
];
function randomAyah(){const a=AYAT[Math.floor(Math.random()*AYAT.length)];const el=document.getElementById('dailyAyah');if(el)el.innerHTML=`<div class="ayah">${a.text}</div><div class="small">${a.ref}</div>`;}

/* Chart */
let radar;function drawRadar(){const ctx=document.getElementById('radar')?.getContext('2d');if(!ctx)return;const labels=LIFE_AREAS;const data=labels.map(l=>lifeScores[l]);if(radar)radar.destroy();radar=new Chart(ctx,{type:'radar',data:{labels,datasets:[{label:'عجلة الحياة',data,fill:true,borderWidth:2}]},options:{responsive:true,plugins:{legend:{display:false}},scales:{r:{suggestedMin:0,suggestedMax:10,ticks:{stepSize:2}}}}});}

/* Roadmap (deeper mapping) */
const NAME_BY_STATE={low:"الرحمن", mid:"اللطيف", high:"الحكيم"};
const AYAH_BY_STATE={low:"﴿وَمَن يَتَوَكَّلْ عَلَى اللَّهِ فَهُوَ حَسْبُهُ﴾",mid:"﴿إِنَّ مَعَ الْعُسْرِ يُسْرًا﴾",high:"﴿وَقُل رَّبِّ زِدْنِي عِلْمًا﴾"};
const CBT_LIBRARY={thought:"اكتب فكرة مزعجة، ثم بديلًا واقعيًا رحيمًا، وطبّق سلوكًا نافعًا صغيرًا.",gratitude:"سجل 3 نِعَم اليوم مع سبب الامتنان.",breath:"تنفّس 4-4-6 لدقيقة (شهيق-ثبات-زفير).",tinyHabit:"عادة دقيقة مرتبطة بإشارة ثابتة (بعد صلاة/قبل نوم)."};
function stateBand(p){return p<60?'low':(p<80?'mid':'high');}
function roadmapBlocks(pct,haw,life){
  const lowAreas=Object.entries(life).sort((a,b)=>a[1]-b[1]).slice(0,3).map(x=>x[0]);
  const band=stateBand(pct);
  const anchorName=NAME_BY_STATE[band];
  const anchorAyah=AYAH_BY_STATE[band];
  const anchors=[`ذكر يومي: "يا ${anchorName}" 100 مرة`,`آية اليوم: ${anchorAyah}`];
  const psych=(band==='low')?CBT_LIBRARY.thought:(band==='mid')?CBT_LIBRARY.gratitude:CBT_LIBRARY.tinyHabit;
  const items=[];
  for(let d=1;d<=14;d++){
    const area=lowAreas[d%lowAreas.length];
    const practice=(d%3===1)?psych:((d%3===2)?CBT_LIBRARY.breath:CBT_LIBRARY.tinyHabit);
    items.push({title:`اليوم ${d}: ${area}`,desc:[...anchors,`خطوة ${area}: 10–20 دقيقة`,practice,"لطف خفي لشخص واحد"].join(" — ")});
  }
  items.push({title:"مراجعة خفيفة",desc:"قيّم التزامك (0–10) وعدّل الخطة."});
  items.push({title:"تثبيت عادة",desc:"اختر عادة واحدة للاستمرار 30 يومًا."});
  return items;
}
function renderRoadmap(){const pct=computeFaithPct();const haw=mapHawkins(pct);const host=byId('roadmapPlan');if(!host)return;host.innerHTML="";roadmapBlocks(pct,haw,lifeScores).forEach(it=>{host.appendChild(el("label",{class:"card anim",html:`<div style="display:flex;gap:10px;align-items:flex-start"><input type="checkbox" style="margin-top:6px"/><div><b>${it.title}</b><div class="small" style="color:var(--muted)">${it.desc}</div></div></div>`}));});}
function downloadPlan(){const html=`<!doctype html><meta charset="utf-8"><title>خطة زد إيمانك (14 يومًا)</title><style>body{font-family:system-ui,"Tajawal";direction:rtl;padding:20px} .task{margin:8px 0;padding:10px;border:1px solid #ddd;border-radius:10px}</style><h2>خطة زد إيمانك (14 يومًا)</h2>${document.getElementById('roadmapPlan').innerHTML}<footer style="margin-top:16px;color:#777;font-size:12px">© شركة تلبية للبحث والتطوير</footer>`;const blob=new Blob([html],{type:"text/html"});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download="iman-roadmap.html";a.click();}

/* Share */
async function shareProgress(){const pct=computeFaithPct();const haw=mapHawkins(pct);const mas=mapMaslow(computeLifeAvg());const text=`نتيجتي في "زد إيمانك": إيمان ${pct}% — هاوكنز: ${haw.label} (${haw.code}) — ماسلو: ${mas}`;if(navigator.share){try{await navigator.share({title:'زد إيمانك',text});}catch(_){}} else {navigator.clipboard?.writeText(text);alert('تم نسخ النتائج للمشاركة.');}}

/* Partner form flow */
function openPartnerForm(){partnerModal.showModal();}
function submitPartnerForm(){
  const name=document.getElementById('pf_name').value.trim();
  const org=document.getElementById('pf_org').value.trim();
  const email=document.getElementById('pf_email').value.trim();
  const phone=document.getElementById('pf_phone').value.trim();
  const type=document.getElementById('pf_type').value.trim();
  const msg=document.getElementById('pf_msg').value.trim();
  if(!name || !email || !type){alert('فضلاً أدخل الاسم والبريد ونوع الشراكة.');return;}
  const body = `مرحباً،\nأرغب بالانضمام كشريك في (زد إيمانك).\n\nالاسم: ${name}\nالمنظمة: ${org||'-'}\nالبريد: ${email}\nالهاتف: ${phone||'-'}\nنوع الشراكة: ${type}\n\nالرسالة:\n${msg||'-'}\n`;
  const mailto = `mailto:partnerships@example.com?subject=${encodeURIComponent('انضمام كشريك - منصة زد إيمانك')}&body=${encodeURIComponent(body)}`;
  window.location.href = mailto;
  uiPing();
  partnerModal.close();
  alert('تم إعداد رسالة البريد. يمكنك إرسالها الآن.');
}

/* Init */
document.getElementById('year').textContent=new Date().getFullYear();
route(); drawRadar(); refreshAll(); randomAyah(); fillHawkinsTable(); setTimeout(()=>{try{fillHawkinsBar();}catch(_){}} ,0);
</script>
</body>
</html>
